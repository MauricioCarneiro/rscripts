{
    "contents" : "require(\"ggplot2\")\n\nuncovered <- function(data, t) {\n  data_points = length(data$POS)\n  percent_uncovered <- length(data[data$AVG_INTERVAL_DP/12 < t,]$POS) / data_points\n  cat(percent_uncovered, percent_uncovered * data_points)\n}\n\nload_downsampled_datasets = function (filename) {\n  master = cbind(\"10%\", read.delim(paste(\"/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.1/\", filename, sep = \"\")))\n  names(master) <- c(\"dataset\", names(master)[-1])\n  for (target in c(20, 30, 40, 50, 70, 80)) {\n    tmp <- cbind(paste(target, \"%\", sep=\"\"), read.delim(paste(\"/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.\", target/10, \"/\", filename, sep = \"\")))\n    names(tmp) <- names(master)\n    master <- rbind(master, tmp)  \n  }\n  master\n}\n\n\n## individual datasets\n\noriginal <- read.delim(\"/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cds/master_cds_gencodeV15.intervals.tbl\")\n#d <- read.delim(\"/Volumes/Lothlorien/Dropbox/sandbox/clia/untargeted.tbl\")\n#d <- read.delim(\"/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cancer/cancer.tbl\")\n\nqplot(AVG_INTERVAL_DP/12, data=d, geom=\"density\", fill=\"red\", xlab=\"Average depth per sample\", ylab=\"% targets\") + geom_vline(xintercept=20, linetype=\"dashed\") + scale_fill_discrete(guide = \"none\")\nqplot(FILTER, data=subset(d, FILTER != \"PASS\")) + theme(axis.text.x = element_text(angle=90, hjust=1))\n\n\n#Downsampled datasets\nd = load_downsampled_datasets(\"master_cds_gencodeV15.intervals.vcf.tbl\")\nuncovered(d=subset(d, dataset==\"10%\"), 20)\nuncovered(d=subset(d, dataset==\"20%\"), 20)\nuncovered(d=subset(d, dataset==\"30%\"), 20)\nuncovered(d=subset(d, dataset==\"40%\"), 20)\nuncovered(d=subset(d, dataset==\"50%\"), 20)\nuncovered(d=subset(d, dataset==\"70%\"), 20)\nuncovered(d=subset(d, dataset==\"80%\"), 20)\n\nqplot(AVG_INTERVAL_DP/12, data=genetest, geom=\"density\", fill=dataset, alpha=0.2, group=dataset, xlab=\"Average depth per sample\", ylab=\"% targets\") + geom_vline(xintercept=20, linetype=\"dashed\") + scale_alpha(guide=\"none\")\n",
    "created" : 1365042913010.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2384353168",
    "id" : "DE4C2A86",
    "lastKnownWriteTime" : 1365511487,
    "path" : "~/Dropbox/src/tdplots/clia_truseq_coverage_analysis.r",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}