diagnose <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/diagnose.tbl")
View(diagnose)
require("ggplot2")
d = diagnose
rm (diagnose)
qplot(AVG_INTERVAL_DP, data=d)
qplot(AVG_INTERVAL_DP/12, data=d)
qplot(AVG_INTERVAL_DP/12, data=d, geom="area")
qplot(AVG_INTERVAL_DP/12, data=d)
qplot(AVG_INTERVAL_DP/12, data=d) + geom_vline(xintercept=20, linetype="dashed")
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/diagnose.tbl")
qplot(AVG_INTERVAL_DP/12, data=d) + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", colour="red") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
d$AVG_INTERVAL_DP < 20
d[d$AVG_INTERVAL_DP < 20,]
length(d[d$AVG_INTERVAL_DP < 20,])
length(d[d$AVG_INTERVAL_DP < 20])
length(d[d$AVG_INTERVAL_DP < 20,]$POS)
length(d)
length(d$POS)
7481/62139
qplot(FILTER, data=d)
qplot(FILTER, data=subset(d, FILTER != "PASS")
qplot(FILTER, data=subset(d, FILTER != "PASS"))
qplot(FILTER, data=subset(d, FILTER != "PASS"))
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90))
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=45))
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90))
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, vjust=1))
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, vjust=0))
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, hjust=1))
u <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/untargeted.tbl")
View(u)
qplot(FILTER, data=subset(u, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, hjust=1))
qplot(FILTER, data=u) + theme(axis.text.x = element_text(angle=90, hjust=1))
length(d[d$AVG_INTERVAL_DP < 10,]$POS)
uncovered <- function(d, t) {
length(d[d$AVG_INTERVAL_DP < t,]$POS) / length(d$POS)
}
uncovered(d, 10)
uncovered(d, 20)
uncovered(d, 5)
length(d$POS)
length(subset(d, FILTER=="LOW_MEDIAN_DEPTH,NO_READS")$POS)
length(subset(d, FILTER=="LOW_MEDIAN_DEPTH,NO_READS")$POS) / length(d$POS)
uncovered(d, 10)/ length(d$POS)
uncovered(d, 10) * length(d$POS)
uncovered(d, 20) * length(d$POS)
uncovered(d, 5) * length(d$POS)
uncovered(d, 1) * length(d$POS)
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/diagnose.cds.tbl")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
require("ggplot2")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
uncovered <- function(d, t) {
length(d[d$AVG_INTERVAL_DP < t,]$POS) / length(d$POS)
}
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, hjust=1))
uncovered(d=d, 20)
uncovered(d=d, 10)
uncovered(d=d, 5)
length(subset(d, FILTER=="LOW_MEDIAN_DEPTH,NO_READS")$POS)
length(subset(d, FILTER=="LOW_MEDIAN_DEPTH,NO_READS")$POS)/length(d$POS)
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
uncovered(d=d, 20) * length(d$POS)
uncovered(d=d, 10)
uncovered(d=d, 10) * length(d$POS)
uncovered(d=d, 5) * length(d$POS)
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/cancerpanel.diagnose.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
require("ggplot2")
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
require("reshape2")
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/halo/diagnose.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/cancerpanel.diagnose.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/cancerpanel.diagnose.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals")
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/cancerpanel.diagnose.tbl")
View(d)
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/halo/diagnose.tbl")
View(d)
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/cancerpanel.diagnose.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals")
o <- read.table("/Volumes/Lothlorien/Dropbox/sandbox/clia/o", header=T)
View(o)
summary(o)
halo <- read.table("/Volumes/Lothlorien/Dropbox/sandbox/clia/halo.error_rate.tbl", header=T)
summary(halo)
sd (o$MM)
sd (halo$MM)
names(halo) = c("MM", "ID")
sd (halo$MM)
sd (halo$ID)
sd (o$ID)
v <- read.table("/humgen/gsa-hpprojects/dev/carneiro/eomi/analysis/noReadPos/nVariantsBySample.tbl", quote="\"")
View(v)
require("ggplot")
require("ggplot2")
data = cbind(c(1:length(v), v))
head data
head (data)
length(v)
length(v$V1)
data = cbind(c(1:length(v$V1), v))
head (data)
c(1:length(v$V1))
cbind(c(1:length(v$V1)), v$V1)
data = cbind(c(1:length(v$V1)), v$V1)
head (data)
data = data.frame(cbind(c(1:length(v$V1)), v$V1))
head(data)
qplot(X1, X2,data=data)
summary(v)
View(v)
sd(v$V1)
mean(v$V1) + 3*sd(v$V1)
subset(data, X2 > (mean(v$V1) + 3*sd(v$V1)))
length(subset(data, X2 > (mean(v$V1) + 3*sd(v$V1)))$X1)
length(subset(data, X2 < (mean(v$V1) - 3*sd(v$V1)))$X1)
v <- read.table("/humgen/gsa-hpprojects/dev/carneiro/eomi/analysis/noReadPos/nVariantsBySample.tbl", quote="\"")
v <- data.frame(cbind(c(1:length(v$V1)), v$V1))
qplot(X1, X2,data=v) +
sdf
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants")
source('~/.active-rstudio-document', echo=TRUE)
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample")
mean(v$V1) + 3*sd(v$V1)
mean(v$X2) + 3*sd(v$X2)
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") + geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2))
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2))
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2)) +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2))
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2))
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2))
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2), linetype="dashed")
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2), linetype="dashed") +
theme_bw()
mean(v$X2) - 3*sd(v$X2)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, hjust=1))
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
uncovered(d, 20)
uncovered(d, 10)
uncovered(d, 5)
uncovered(d, 20)*length(d$POS)
mean(d$AVG_INTERVAL_DP)
mean(d$AVG_INTERVAL_DP/12)
median(d$AVG_INTERVAL_DP/12)
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cancer/cancer.tbl")
View(d)
d$AVG_INTERVAL_DP/12 < 20
d[d$AVG_INTERVAL_DP/12 < 20]
d[d$AVG_INTERVAL_DP/12 < 20,]
with(d[d$AVG_INTERVAL_DP/12 < 20], CHROM)
d[d$AVG_INTERVAL_DP/12 < 20]$CHROM
d[d$AVG_INTERVAL_DP/12 < 20]
d[d$AVG_INTERVAL_DP/12 < 20,]
d[d$AVG_INTERVAL_DP/12 < 20,]$CHROM
cbind(,
df
piowjer32)
t = d[d$AVG_INTERVAL_DP/12 < 20,]$CHROM
cbind(t$chrom, t$POS, t$END)
t = d[d$AVG_INTERVAL_DP/12 < 20,]
data.frame(cbind(t$CHROM, t$POS, t$END))
dd =data.frame(cbind(t$CHROM, t$POS, t$END))
dd[sort(t$CHROM)]
dd[sort(t$CHROM),]
dd[sort(as.numeric(t$CHROM)),]
head(dd)
names(dd) <- c("chr", "start", "end")
head(dd)
dd[sort(dd$chr),]
dd =dd[sort(dd$chr),]
dd
dd[1:3,]
dd[2:4,]
dd
length(dd$chr)
uncovered <- function(d, t) {
length(d[d$AVG_INTERVAL_DP/12 < t,]$POS) / length(d$POS)
}
uncovered(d, 20)
uncovered(d, 20) * d$POS
uncovered(d, 20) * length(d$POS)
length(dd$chr)
uncovered(d, 20) * length(d$POS)
uncovered(d, 20)
write.table(dd, file="~/sandbox/cancer.uncovered.tbl")
View(d)
rm (o, m ,t)
rm(halo, dd)
u = subset(d, AVG_INTERVAL_DP / 12 < 20)
View(u)
write.table(u, "~/sandbox/clia/cancer.uncovered.tbl")
require("ggplot2")
uncovered <- function(data, t) {
data_points = length(data$POS)
percent_uncovered <- length(data[data$AVG_INTERVAL_DP/12 < t,]$POS) / data_points
cat(percent_uncovered, percent_uncovered * data_points)
}
d <- cbind("10%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.1/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(d) <- c("dataset", names(d)[-1])
tmp <- cbind("20%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.2/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(tmp) <- names(d)
d <- rbind(d, tmp)
tmp <- cbind("30%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.3/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(tmp) <- names(d)
d <- rbind(d, tmp)
tmp <- cbind("40%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.4/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(tmp) <- names(d)
d <- rbind(d, tmp)
tmp <- cbind("50%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(tmp) <- names(d)
d <- rbind(d, tmp)
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(d=subset(d, dataset=="20%"), 20)
uncovered(d=subset(d, dataset=="30%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered(d=subset(d, dataset=="50%"), 20)
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_alpha(guide="none")
original <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cds/master_cds_gencodeV15.intervals.tbl")
uncovered(original, 20)
x = cat("d","a")
x
x = paste("x", "a")
x
x = paste("x", "a", sep="")
x
rm(x)
x = data.frame()
names(x) = c("a", "b", "c")
load_downsampled_datasets = function (master, filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/", filename, sep = "")))
names(d) <- c("dataset", names(d)[-1])
for target in (c(20, 30, 40, 50)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
load_downsampled_datasets = function (master, filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/", filename, sep = "")))
names(master) <- c("dataset", names(d)[-1])
for target in (c(20, 30, 40, 50)) {
load_downsampled_datasets = function (master, filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/", filename, sep = "")))
names(master) <- c("dataset", names(d)[-1])
for (target in c(20, 30, 40, 50)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
}
load_downsampled_datasets = function (filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/", filename, sep = "")))
names(master) <- c("dataset", names(d)[-1])
for (target in c(20, 30, 40, 50)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
master
}
load_downsampled_datasets(filename="GeneTest-transcripts-130221.intervals.vcf.tbl")
load_downsampled_datasets = function (filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/", filename, sep = "")))
names(master) <- c("dataset", names(master)[-1])
for (target in c(20, 30, 40, 50)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
master
}
load_downsampled_datasets(filename="GeneTest-transcripts-130221.intervals.vcf.tbl")
genetest = load_downsampled_datasets(filename="GeneTest-transcripts-130221.intervals.vcf.tbl")
summary(genetest)
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_alpha(guide="none")
require("ggplot2")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_alpha(guide="none")
qplot(AVG_INTERVAL_DP/12, data=genetest, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_alpha(guide="none")
d = load_downsampled_datasets(master_cds_gencodeV15.intervals.vcf)
load_downsampled_datasets = function (filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/", filename, sep = "")))
names(master) <- c("dataset", names(master)[-1])
for (target in c(20, 30, 40, 50)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
master
}
d = load_downsampled_datasets(master_cds_gencodeV15.intervals.vcf)
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf")
head(d)
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf.tbl")
head(d)
summary(d)
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered <- function(data, t) {
data_points = length(data$POS)
percent_uncovered <- length(data[data$AVG_INTERVAL_DP/12 < t,]$POS) / data_points
cat(percent_uncovered, percent_uncovered * data_points)
}
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(d=subset(d, dataset=="20%"), 20)
uncovered(d=subset(d, dataset=="30%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered(d=subset(d, dataset=="50%"), 20)
uncovered(d=subset(d, dataset=="10%"), 20)
load_downsampled_datasets = function (filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.1/", filename, sep = "")))
names(master) <- c("dataset", names(master)[-1])
for (target in c(20, 30, 40, 50)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
master
}
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf.tbl")
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(d=subset(d, dataset=="20%"), 20)
uncovered(d=subset(d, dataset=="30%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered(d=subset(d, dataset=="50%"), 20)
qplot(AVG_INTERVAL_DP/12, data=genetest, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_alpha(guide="none")
original <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cds/master_cds_gencodeV15.intervals.tbl")
uncovered(original, 20)
qplot(AVG_INTERVAL_DP/12, data=genetest, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_alpha(guide="none")
summary(d)
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(d=subset(d, dataset=="20%"), 20)
uncovered(d=subset(d, dataset=="30%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered(d=subset(d, dataset=="50%"), 20)
uncovered(original, 20)
z=data.frame(rbind(c(10, 8783), c(20, 2141), c(30, 1345), c(40, 1068), c(50, 941), c(100, 707)))
z
names(z) <- c("downsample", "uncovered")
qplot(downsample, uncovered, data=z)
qplot(downsample, uncovered, data=z) + geom_smooth()
load_downsampled_datasets = function (filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.1/", filename, sep = "")))
names(master) <- c("dataset", names(master)[-1])
for (target in c(20, 30, 40, 50, 60, 70, 80, 90)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
master
}
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf.tbl")
load_downsampled_datasets = function (filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.1/", filename, sep = "")))
names(master) <- c("dataset", names(master)[-1])
for (target in c(20, 30, 40, 50, 70, 80)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
master
}
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf.tbl")
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf.tbl")
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf.tbl")
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(d=subset(d, dataset=="20%"), 20)
uncovered(d=subset(d, dataset=="30%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered(d=subset(d, dataset=="50%"), 20)
uncovered(d=subset(d, dataset=="70%"), 20)
uncovered(d=subset(d, dataset=="80%"), 20)
z = rbind (z, c(70, 802), c(80, 759))
qplot(downsample, uncovered, z)
qplot(downsample, uncovered, data=z)
qplot(downsample, uncovered, data=z) + geom_smooth()
qplot(downsample, uncovered, data=z) + geom_smooth(method="lm")
qplot(downsample, uncovered, data=z) + geom_smooth(method="glm")
qplot(downsample, uncovered, data=z) + geom_smooth(method="gam")
qplot(downsample, uncovered, data=z) + geom_smooth(method="rlm")
qplot(downsample, uncovered, data=z) + geom_smooth(method="loess")
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/tsca/analysis/eomi_rerun.pool1.diagnose.vcf.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
require("ggplot2")
require("reshape2")
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
View(d)
m = melt(d, id.vars="id", measure.vars=names(d)[6:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals") + theme(axis.text.x=element_text(angle=90))
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/tsca/analysis/eomi_rerun.pool2.diagnose.vcf.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[6:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals") + theme(axis.text.x=element_text(angle=90))
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals") + theme(axis.text.x=element_text(angle=90)) + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, group=id, data=m, geom="boxplot", alpha = 0.1,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, group=id, data=m, geom="boxplot", color=variable,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, group=id, data=m, geom="point", color=variable,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, alpha=0.1, data=m, geom="point", color=variable,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, alpha=0.1, data=m, geom="point", color=variable,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed") + scale_color_discrete(guide="none")
qplot(id, value, alpha=0.1, data=m, geom="point", color=variable,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed") + scale_color_discrete(guide="none") + scale_alpha_continuous(guide="none")
