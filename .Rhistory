subset(data, X2 > (mean(v$V1) + 3*sd(v$V1)))
length(subset(data, X2 > (mean(v$V1) + 3*sd(v$V1)))$X1)
length(subset(data, X2 < (mean(v$V1) - 3*sd(v$V1)))$X1)
v <- read.table("/humgen/gsa-hpprojects/dev/carneiro/eomi/analysis/noReadPos/nVariantsBySample.tbl", quote="\"")
v <- data.frame(cbind(c(1:length(v$V1)), v$V1))
qplot(X1, X2,data=v) +
sdf
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants")
source('~/.active-rstudio-document', echo=TRUE)
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample")
mean(v$V1) + 3*sd(v$V1)
mean(v$X2) + 3*sd(v$X2)
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") + geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2))
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2))
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2)) +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2))
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2))
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2))
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2), linetype="dashed")
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2), linetype="dashed") +
theme_bw()
mean(v$X2) - 3*sd(v$X2)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, hjust=1))
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
uncovered(d, 20)
uncovered(d, 10)
uncovered(d, 5)
uncovered(d, 20)*length(d$POS)
mean(d$AVG_INTERVAL_DP)
mean(d$AVG_INTERVAL_DP/12)
median(d$AVG_INTERVAL_DP/12)
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cancer/cancer.tbl")
View(d)
d$AVG_INTERVAL_DP/12 < 20
d[d$AVG_INTERVAL_DP/12 < 20]
d[d$AVG_INTERVAL_DP/12 < 20,]
with(d[d$AVG_INTERVAL_DP/12 < 20], CHROM)
d[d$AVG_INTERVAL_DP/12 < 20]$CHROM
d[d$AVG_INTERVAL_DP/12 < 20]
d[d$AVG_INTERVAL_DP/12 < 20,]
d[d$AVG_INTERVAL_DP/12 < 20,]$CHROM
cbind(,
df
piowjer32)
t = d[d$AVG_INTERVAL_DP/12 < 20,]$CHROM
cbind(t$chrom, t$POS, t$END)
t = d[d$AVG_INTERVAL_DP/12 < 20,]
data.frame(cbind(t$CHROM, t$POS, t$END))
dd =data.frame(cbind(t$CHROM, t$POS, t$END))
dd[sort(t$CHROM)]
dd[sort(t$CHROM),]
dd[sort(as.numeric(t$CHROM)),]
head(dd)
names(dd) <- c("chr", "start", "end")
head(dd)
dd[sort(dd$chr),]
dd =dd[sort(dd$chr),]
dd
dd[1:3,]
dd[2:4,]
dd
length(dd$chr)
uncovered <- function(d, t) {
length(d[d$AVG_INTERVAL_DP/12 < t,]$POS) / length(d$POS)
}
uncovered(d, 20)
uncovered(d, 20) * d$POS
uncovered(d, 20) * length(d$POS)
length(dd$chr)
uncovered(d, 20) * length(d$POS)
uncovered(d, 20)
write.table(dd, file="~/sandbox/cancer.uncovered.tbl")
View(d)
rm (o, m ,t)
rm(halo, dd)
u = subset(d, AVG_INTERVAL_DP / 12 < 20)
View(u)
write.table(u, "~/sandbox/clia/cancer.uncovered.tbl")
require("ggplot2")
uncovered <- function(data, t) {
data_points = length(data$POS)
percent_uncovered <- length(data[data$AVG_INTERVAL_DP/12 < t,]$POS) / data_points
cat(percent_uncovered, percent_uncovered * data_points)
}
d <- cbind("10%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.1/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(d) <- c("dataset", names(d)[-1])
tmp <- cbind("20%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.2/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(tmp) <- names(d)
d <- rbind(d, tmp)
tmp <- cbind("30%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.3/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(tmp) <- names(d)
d <- rbind(d, tmp)
tmp <- cbind("40%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.4/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(tmp) <- names(d)
d <- rbind(d, tmp)
tmp <- cbind("50%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(tmp) <- names(d)
d <- rbind(d, tmp)
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(d=subset(d, dataset=="20%"), 20)
uncovered(d=subset(d, dataset=="30%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered(d=subset(d, dataset=="50%"), 20)
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_alpha(guide="none")
original <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cds/master_cds_gencodeV15.intervals.tbl")
uncovered(original, 20)
x = cat("d","a")
x
x = paste("x", "a")
x
x = paste("x", "a", sep="")
x
rm(x)
x = data.frame()
names(x) = c("a", "b", "c")
load_downsampled_datasets = function (master, filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/", filename, sep = "")))
names(d) <- c("dataset", names(d)[-1])
for target in (c(20, 30, 40, 50)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
load_downsampled_datasets = function (master, filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/", filename, sep = "")))
names(master) <- c("dataset", names(d)[-1])
for target in (c(20, 30, 40, 50)) {
load_downsampled_datasets = function (master, filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/", filename, sep = "")))
names(master) <- c("dataset", names(d)[-1])
for (target in c(20, 30, 40, 50)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
}
load_downsampled_datasets = function (filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/", filename, sep = "")))
names(master) <- c("dataset", names(d)[-1])
for (target in c(20, 30, 40, 50)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
master
}
load_downsampled_datasets(filename="GeneTest-transcripts-130221.intervals.vcf.tbl")
load_downsampled_datasets = function (filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/", filename, sep = "")))
names(master) <- c("dataset", names(master)[-1])
for (target in c(20, 30, 40, 50)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
master
}
load_downsampled_datasets(filename="GeneTest-transcripts-130221.intervals.vcf.tbl")
genetest = load_downsampled_datasets(filename="GeneTest-transcripts-130221.intervals.vcf.tbl")
summary(genetest)
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_alpha(guide="none")
require("ggplot2")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_alpha(guide="none")
qplot(AVG_INTERVAL_DP/12, data=genetest, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_alpha(guide="none")
d = load_downsampled_datasets(master_cds_gencodeV15.intervals.vcf)
load_downsampled_datasets = function (filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/", filename, sep = "")))
names(master) <- c("dataset", names(master)[-1])
for (target in c(20, 30, 40, 50)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
master
}
d = load_downsampled_datasets(master_cds_gencodeV15.intervals.vcf)
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf")
head(d)
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf.tbl")
head(d)
summary(d)
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered <- function(data, t) {
data_points = length(data$POS)
percent_uncovered <- length(data[data$AVG_INTERVAL_DP/12 < t,]$POS) / data_points
cat(percent_uncovered, percent_uncovered * data_points)
}
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(d=subset(d, dataset=="20%"), 20)
uncovered(d=subset(d, dataset=="30%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered(d=subset(d, dataset=="50%"), 20)
uncovered(d=subset(d, dataset=="10%"), 20)
load_downsampled_datasets = function (filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.1/", filename, sep = "")))
names(master) <- c("dataset", names(master)[-1])
for (target in c(20, 30, 40, 50)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
master
}
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf.tbl")
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(d=subset(d, dataset=="20%"), 20)
uncovered(d=subset(d, dataset=="30%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered(d=subset(d, dataset=="50%"), 20)
qplot(AVG_INTERVAL_DP/12, data=genetest, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_alpha(guide="none")
original <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cds/master_cds_gencodeV15.intervals.tbl")
uncovered(original, 20)
qplot(AVG_INTERVAL_DP/12, data=genetest, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_alpha(guide="none")
summary(d)
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(d=subset(d, dataset=="20%"), 20)
uncovered(d=subset(d, dataset=="30%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered(d=subset(d, dataset=="50%"), 20)
uncovered(original, 20)
z=data.frame(rbind(c(10, 8783), c(20, 2141), c(30, 1345), c(40, 1068), c(50, 941), c(100, 707)))
z
names(z) <- c("downsample", "uncovered")
qplot(downsample, uncovered, data=z)
qplot(downsample, uncovered, data=z) + geom_smooth()
load_downsampled_datasets = function (filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.1/", filename, sep = "")))
names(master) <- c("dataset", names(master)[-1])
for (target in c(20, 30, 40, 50, 60, 70, 80, 90)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
master
}
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf.tbl")
load_downsampled_datasets = function (filename) {
master = cbind("10%", read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.1/", filename, sep = "")))
names(master) <- c("dataset", names(master)[-1])
for (target in c(20, 30, 40, 50, 70, 80)) {
tmp <- cbind(paste(target, "%", sep=""), read.delim(paste("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.", target/10, "/", filename, sep = "")))
names(tmp) <- names(master)
master <- rbind(master, tmp)
}
master
}
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf.tbl")
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf.tbl")
d = load_downsampled_datasets("master_cds_gencodeV15.intervals.vcf.tbl")
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(d=subset(d, dataset=="20%"), 20)
uncovered(d=subset(d, dataset=="30%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered(d=subset(d, dataset=="50%"), 20)
uncovered(d=subset(d, dataset=="70%"), 20)
uncovered(d=subset(d, dataset=="80%"), 20)
z = rbind (z, c(70, 802), c(80, 759))
qplot(downsample, uncovered, z)
qplot(downsample, uncovered, data=z)
qplot(downsample, uncovered, data=z) + geom_smooth()
qplot(downsample, uncovered, data=z) + geom_smooth(method="lm")
qplot(downsample, uncovered, data=z) + geom_smooth(method="glm")
qplot(downsample, uncovered, data=z) + geom_smooth(method="gam")
qplot(downsample, uncovered, data=z) + geom_smooth(method="rlm")
qplot(downsample, uncovered, data=z) + geom_smooth(method="loess")
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/tsca/analysis/eomi_rerun.pool1.diagnose.vcf.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
require("ggplot2")
require("reshape2")
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
View(d)
m = melt(d, id.vars="id", measure.vars=names(d)[6:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals") + theme(axis.text.x=element_text(angle=90))
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/tsca/analysis/eomi_rerun.pool2.diagnose.vcf.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[6:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals") + theme(axis.text.x=element_text(angle=90))
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals") + theme(axis.text.x=element_text(angle=90)) + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, group=id, data=m, geom="boxplot", alpha = 0.1,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, group=id, data=m, geom="boxplot", color=variable,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, group=id, data=m, geom="point", color=variable,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, alpha=0.1, data=m, geom="point", color=variable,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, alpha=0.1, data=m, geom="point", color=variable,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed") + scale_color_discrete(guide="none")
qplot(id, value, alpha=0.1, data=m, geom="point", color=variable,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed") + scale_color_discrete(guide="none") + scale_alpha_continuous(guide="none")
ffpe <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/ffpe/master_cds_gencodeV15.intervals.d1.0.vcf.tbl")
require("ggplot2")
qplot(AVG_INTERVAL_DP/12, data=original, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(AVG_INTERVAL_DP/12, data=ffpe, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, hjust=1))
dx <- ffpe
qplot(AVG_INTERVAL_DP/12, data=dx, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(FILTER, data=subset(dx, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, hjust=1))
dx <- ffpe
qplot(AVG_INTERVAL_DP/12, data=dx, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
median(dx$AVG_INTERVAL_DP/12)
uncovered(dx, 20)
uncovered(dx, 20) * median(dx$AVG_INTERVAL_DP/12)
uncovered(dx, 20) * length(dx$POS)
original <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cds/master_cds_gencodeV15.intervals.tbl")
uncovered(dx, 20) * length(original$POS)
length(original$POS)
length(ffpe$POS)
qplot(AVG_INTERVAL_DP, data=dx, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
median(dx$AVG_INTERVAL_DP)
uncovered(dx, 20) * length(original$POS)
original <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cds/master_cds_gencodeV15.intervals.tbl")
cancer_cells <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cancer_cells/master_cds_gencodeV15.intervals.d1.0.vcf.tbl")
dx <- cancer_cells
median(dx$AVG_INTERVAL_DP)
uncovered(dx, 20) * length(original$POS)
qplot(AVG_INTERVAL_DP/12, data=dx, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
View(cancer_cells)
dx <- cancer_cells
median(dx$AVG_INTERVAL_DP/4)
uncovered(dx, 20) * length(original$POS)
qplot(AVG_INTERVAL_DP/4, data=dx, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(AVG_INTERVAL_DP/4, data=dx, geom="density", fill="red", xlim=c(0,500), xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(AVG_INTERVAL_DP/4, data=dx, geom="density", fill="red", xlim=c(0,750), xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
uncovered(dx, 20)
median(dx$AVG_INTERVAL_DP/4)
uncovered(dx, 20)
uncovered(dx, 20) * 72072
dx <- ffpe
median(dx$AVG_INTERVAL_DP/4)
uncovered(dx, 20)
uncovered(dx, 20) * 72072
qplot(AVG_INTERVAL_DP/4, data=dx, geom="density", fill="red", xlim=c(0,750), xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(AVG_INTERVAL_DP, data=dx, geom="density", fill="red", xlim=c(0,750), xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
cancer_cells <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/tissue_cells/master_cds_gencodeV15.intervals.d1.0.vcf.tbl")
original <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cds/master_cds_gencodeV15.intervals.d1.0.vcf.tbl")
dx <- original
nsamples <- 1
nsamples <- 12
median(dx$AVG_INTERVAL_DP/nsamples)
uncovered(dx, 20)
uncovered(dx, 20) * 72072
qplot(AVG_INTERVAL_DP/nsamples, data=dx, geom="density", fill="red", xlim=c(0,750), xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
require("ggplot2")
qplot(AVG_INTERVAL_DP/nsamples, data=dx, geom="density", fill="red", xlim=c(0,750), xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(AVG_INTERVAL_DP/nsamples, data=dx, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
pre <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cds/no_mito_master_cds_gencodeV15.intervals.tbl")
dx <- pre
nsamples <- 12
median(dx$AVG_INTERVAL_DP/nsamples)
uncovered(dx, 20)
uncovered(dx, 20) * 72072
qplot(AVG_INTERVAL_DP/nsamples, data=dx, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
trio <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/trio/master_cds_gencodeV15.intervals.d1.0.vcf.tbl")
trio <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/trio/master_cds_gencodeV15.intervals.d1.0.vcf.tbl")
dx <- trio
head(dx)
nsamples <- 3
median(dx$AVG_INTERVAL_DP/nsamples)
uncovered(dx, 20)
uncovered(dx, 20) * 72072
qplot(AVG_INTERVAL_DP/nsamples, data=dx, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
tumor <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/tumor_normal/master_cds_gencodeV15.intervals.d1.0.vcf.tbl")
dx <- tumor
nsamples <- 3
median(dx$AVG_INTERVAL_DP/nsamples)
uncovered(dx, 20)
uncovered(dx, 20) * 72072
qplot(AVG_INTERVAL_DP/nsamples, data=dx, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
head(dx)
nsamples <- 2
median(dx$AVG_INTERVAL_DP/nsamples)
uncovered(dx, 20)
uncovered(dx, 20) * 72072
qplot(AVG_INTERVAL_DP/nsamples, data=dx, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(AVG_INTERVAL_DP/nsamples, data=dx, xlim=c(0,500), geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(AVG_INTERVAL_DP/nsamples, data=dx, xlim=c(0,750), geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
nsamples <- 2
median(dx$AVG_INTERVAL_DP/nsamples)
uncovered(dx, 20)
uncovered(dx, 20) * 72072
normal <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/tumor_normal/normal/master_cds_gencodeV15.intervals.d1.0.vcf.tbl")
dx <- normal
head(dx)
nsamples <- 2
median(dx$AVG_INTERVAL_DP/nsamples)
uncovered(dx, 20)
uncovered(dx, 20) * 72072
qplot(AVG_INTERVAL_DP/nsamples, data=dx, xlim=c(0,750), geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
head(original)
dx <- original
nsamples <- 2
median(dx$AVG_INTERVAL_DP/nsamples)
qplot(AVG_INTERVAL_DP/nsamples, data=dx, xlim=c(0,750), geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
original[5:13,]
head(original[,5:13])
head(original[,5:14])
head(original[,5:14] < 20)
original[original[,5:14] < 20]
head(original[original[,5:14] < 20])
(original[original[,5:14] < 20,])
head(original[original[,5:14] < 20,])
length(head(original[original[,5:14] < 20,])$POS)
percent_uncovered * data_points
length(original[original[,5:14] < 20,]$POS)
c(21, 23, 19) < 20 ?
c(21, 23, 19) < 20 ?
c(21, 23, 19) < 20
c(21, 23, 19) < 20
x = data.frame(c(21, 23, 19), c(23, 32, 20), c(1, 2, 3))
x
x[x[,1:3] < 20 ,]
x[,1:3]
x[,1:3] < 20
x = data.frame(rbind(c(21, 23, 19), c(23, 32, 20), c(1, 2, 3)))
x
x[,1:3] < 20
x[x[,1:3] < 20,]
View(d)
View(original)
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/tsca/analysis/combined/eomi_rerun.pool1.list.d1.0.vcf.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
require("ggplot2")
require("reshape2")
install.packages(c("ggplot2", "reshape2"))
require("ggplot2")
require("reshape2")
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/tsca/analysis/combined/eomi_rerun.pool1.list.d1.0.vcf.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[6:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals") + theme(axis.text.x=element_text(angle=90)) + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, alpha=0.1, data=m, geom="point", color=variable,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed") + scale_color_discrete(guide="none") + scale_alpha_continuous(guide="none")
View(d)
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/tsca/analysis/eomi_rerun.pool1.diagnose.vcf.tbl")
d2 <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/tsca/analysis/combined/eomi_rerun.pool1.list.d1.0.vcf.tbl")
View(`d2`)
View(d)
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/tsca/analysis/polymerase.tbl", header=F)
View(d)
names(d) <- c("sample", "mismatch", "indel")
qplot(sample, indel, data=d)
qplot(sample, indel, data=d[with(d, order(indel)),])
qplot(sample, indel, data=d)
x = d[with(d, order(indel)), ]
View(x)
qplot(sample, indel, data=x)
View(x)
qplot(sample, indel, data=x) + theme(axis.text.x=element_text(angle=90))
View(d)
require("ggplot2")
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/tsca/analysis/polymerase.tbl", header=F)
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/tsca/analysis/polymerase.tbl", header=T)
qplot(sample, indel, data=x) + theme(axis.text.x=element_text(angle=90))
qplot(polymerase, indel, data=x) + theme(axis.text.x=element_text(angle=90))
View(d)
qplot(polymerase, indel, data=d) + theme(axis.text.x=element_text(angle=90))
qplot(polymerase, indel, data=d, color=polymerase) + theme(axis.text.x=element_text(angle=90))
qplot(polymerase, indel, data=d, color=polymerase, geom="histogram") + theme(axis.text.x=element_text(angle=90))
qplot(polymerase, indel, data=d, color=polymerase, geom="polygon") + theme(axis.text.x=element_text(angle=90))
qplot(polymerase, indel, data=d, fill=polymerase, geom="polygon") + theme(axis.text.x=element_text(angle=90))
color
qplot(polymerase, indel, data=d, color=polymerase, geom="polygon") + theme(axis.text.x=element_text(angle=90))
qplot(polymerase, mismatch, data=d, color=polymerase, geom="polygon") + theme(axis.text.x=element_text(angle=90))
qplot(polymerase, indel, data=d, color=polymerase, geom="polygon") + theme(axis.text.x=element_text(angle=90))
qplot(polymerase, mismatch, data=d, color=polymerase, geom="polygon") + theme(axis.text.x=element_text(angle=90))
qplot(polymerase, indel, data=d, color=polymerase, geom="polygon") + theme(axis.text.x=element_text(angle=90))
qplot(polymerase, mismatch, data=d, color=polymerase, geom="polygon") + theme(axis.text.x=element_text(angle=90))
qplot(mismatch, indel, data=d, color=polymerase)
qplot(mismatch, indel, data=d, log="xy", color=polymerase)
qplot(mismatch, indel, data=d, color=polymerase)
qplot(mismatch, indel, data=d, color=polymerase, size=2)
qplot(mismatch, indel, data=d, color=polymerase, size=2) + scale_size(guide="none")
qplot(mismatch, indel, data=d, color=polymerase, size=2, xlab="mismatch error", ylab="indel error") + scale_size(guide="none")
qplot(mismatch, indel, data=d, color=polymerase, size=2, main="performance of different polymerases on TSCA data", xlab="mismatch error rate", ylab="indel error rate") + scale_size(guide="none")
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/tsca/analysis/hiseq/hiseq.list.diagnose.tbl")
require("ggplot2")
require("reshape2")
install.packages(c("ggplot2", "reshape2"))
require("ggplot2")
require("reshape2")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[6:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals") + theme(axis.text.x=element_text(angle=90)) + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, alpha=0.1, data=m, geom="point", color=variable,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed") + scale_color_discrete(guide="none") + scale_alpha_continuous(guide="none")
pdf(file="~/combined_hiseq_miseq.pdf")
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals") + theme(axis.text.x=element_text(angle=90)) + geom_hline(yintercept=20, linetype="dashed")
qplot(id, value, alpha=0.1, data=m, geom="point", color=variable,  xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target") + geom_hline(yintercept=20, linetype="dashed") + scale_color_discrete(guide="none") + scale_alpha_continuous(guide="none")
dev.off()
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals") + theme(axis.text.x=element_text(angle=90)) + geom_hline(yintercept=20, linetype="dashed")
