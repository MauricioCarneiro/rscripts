diagnose <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/diagnose.tbl")
View(diagnose)
require("ggplot2")
d = diagnose
rm (diagnose)
qplot(AVG_INTERVAL_DP, data=d)
qplot(AVG_INTERVAL_DP/12, data=d)
qplot(AVG_INTERVAL_DP/12, data=d, geom="area")
qplot(AVG_INTERVAL_DP/12, data=d)
qplot(AVG_INTERVAL_DP/12, data=d) + geom_vline(xintercept=20, linetype="dashed")
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/diagnose.tbl")
qplot(AVG_INTERVAL_DP/12, data=d) + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", colour="red") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
d$AVG_INTERVAL_DP < 20
d[d$AVG_INTERVAL_DP < 20,]
length(d[d$AVG_INTERVAL_DP < 20,])
length(d[d$AVG_INTERVAL_DP < 20])
length(d[d$AVG_INTERVAL_DP < 20,]$POS)
length(d)
length(d$POS)
7481/62139
qplot(FILTER, data=d)
qplot(FILTER, data=subset(d, FILTER != "PASS")
qplot(FILTER, data=subset(d, FILTER != "PASS"))
qplot(FILTER, data=subset(d, FILTER != "PASS"))
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90))
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=45))
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90))
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, vjust=1))
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, vjust=0))
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, hjust=1))
u <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/untargeted.tbl")
View(u)
qplot(FILTER, data=subset(u, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, hjust=1))
qplot(FILTER, data=u) + theme(axis.text.x = element_text(angle=90, hjust=1))
length(d[d$AVG_INTERVAL_DP < 10,]$POS)
uncovered <- function(d, t) {
length(d[d$AVG_INTERVAL_DP < t,]$POS) / length(d$POS)
}
uncovered(d, 10)
uncovered(d, 20)
uncovered(d, 5)
length(d$POS)
length(subset(d, FILTER=="LOW_MEDIAN_DEPTH,NO_READS")$POS)
length(subset(d, FILTER=="LOW_MEDIAN_DEPTH,NO_READS")$POS) / length(d$POS)
uncovered(d, 10)/ length(d$POS)
uncovered(d, 10) * length(d$POS)
uncovered(d, 20) * length(d$POS)
uncovered(d, 5) * length(d$POS)
uncovered(d, 1) * length(d$POS)
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/diagnose.cds.tbl")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
require("ggplot2")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
uncovered <- function(d, t) {
length(d[d$AVG_INTERVAL_DP < t,]$POS) / length(d$POS)
}
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, hjust=1))
uncovered(d=d, 20)
uncovered(d=d, 10)
uncovered(d=d, 5)
length(subset(d, FILTER=="LOW_MEDIAN_DEPTH,NO_READS")$POS)
length(subset(d, FILTER=="LOW_MEDIAN_DEPTH,NO_READS")$POS)/length(d$POS)
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
uncovered(d=d, 20) * length(d$POS)
uncovered(d=d, 10)
uncovered(d=d, 10) * length(d$POS)
uncovered(d=d, 5) * length(d$POS)
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/cancerpanel.diagnose.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
require("ggplot2")
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
require("reshape2")
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/halo/diagnose.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/cancerpanel.diagnose.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/cancerpanel.diagnose.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals")
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/cancerpanel.diagnose.tbl")
View(d)
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/halo/diagnose.tbl")
View(d)
d <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/cancerpanel.diagnose.tbl")
d <- d[with(d, order(AVG_INTERVAL_DP)), ]
d <- cbind(1:length(d[,1]), d)
names(d) <- c("id", names(d)[2:length(d)])
m = melt(d, id.vars="id", measure.vars=names(d)[5:length(d)])
qplot(id, value, group=id, data=m, geom="boxplot", xlab = "target", ylab="median depth", main="TSCA: depth distribution per sample for each target")
qplot(variable, value, group=variable, data=m, geom="boxplot", xlab = "", ylab="median depth", main="TSCA: sample coverage across intervals")
o <- read.table("/Volumes/Lothlorien/Dropbox/sandbox/clia/o", header=T)
View(o)
summary(o)
halo <- read.table("/Volumes/Lothlorien/Dropbox/sandbox/clia/halo.error_rate.tbl", header=T)
summary(halo)
sd (o$MM)
sd (halo$MM)
names(halo) = c("MM", "ID")
sd (halo$MM)
sd (halo$ID)
sd (o$ID)
v <- read.table("/humgen/gsa-hpprojects/dev/carneiro/eomi/analysis/noReadPos/nVariantsBySample.tbl", quote="\"")
View(v)
require("ggplot")
require("ggplot2")
data = cbind(c(1:length(v), v))
head data
head (data)
length(v)
length(v$V1)
data = cbind(c(1:length(v$V1), v))
head (data)
c(1:length(v$V1))
cbind(c(1:length(v$V1)), v$V1)
data = cbind(c(1:length(v$V1)), v$V1)
head (data)
data = data.frame(cbind(c(1:length(v$V1)), v$V1))
head(data)
qplot(X1, X2,data=data)
summary(v)
View(v)
sd(v$V1)
mean(v$V1) + 3*sd(v$V1)
subset(data, X2 > (mean(v$V1) + 3*sd(v$V1)))
length(subset(data, X2 > (mean(v$V1) + 3*sd(v$V1)))$X1)
length(subset(data, X2 < (mean(v$V1) - 3*sd(v$V1)))$X1)
v <- read.table("/humgen/gsa-hpprojects/dev/carneiro/eomi/analysis/noReadPos/nVariantsBySample.tbl", quote="\"")
v <- data.frame(cbind(c(1:length(v$V1)), v$V1))
qplot(X1, X2,data=v) +
sdf
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants")
source('~/.active-rstudio-document', echo=TRUE)
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample")
mean(v$V1) + 3*sd(v$V1)
mean(v$X2) + 3*sd(v$X2)
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") + geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2))
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2))
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2)) +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2))
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2))
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2))
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2), linetype="dashed")
qplot(X1, X2,data=v, xlab="Sample index", ylab="Total Variants", main="Total number of variants per sample") +
geom_hline(yintercept=mean(v$X2) + 3*sd(v$X2), linetype="dashed") +
geom_hline(yintercept=mean(v$X2) - 3*sd(v$X2), linetype="dashed") +
theme_bw()
mean(v$X2) - 3*sd(v$X2)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(FILTER, data=subset(d, FILTER != "PASS")) + theme(axis.text.x = element_text(angle=90, hjust=1))
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
uncovered(d, 20)
uncovered(d, 10)
uncovered(d, 5)
uncovered(d, 20)*length(d$POS)
mean(d$AVG_INTERVAL_DP)
mean(d$AVG_INTERVAL_DP/12)
median(d$AVG_INTERVAL_DP/12)
d <- read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/cancer/cancer.tbl")
View(d)
d$AVG_INTERVAL_DP/12 < 20
d[d$AVG_INTERVAL_DP/12 < 20]
d[d$AVG_INTERVAL_DP/12 < 20,]
with(d[d$AVG_INTERVAL_DP/12 < 20], CHROM)
d[d$AVG_INTERVAL_DP/12 < 20]$CHROM
d[d$AVG_INTERVAL_DP/12 < 20]
d[d$AVG_INTERVAL_DP/12 < 20,]
d[d$AVG_INTERVAL_DP/12 < 20,]$CHROM
cbind(,
df
piowjer32)
t = d[d$AVG_INTERVAL_DP/12 < 20,]$CHROM
cbind(t$chrom, t$POS, t$END)
t = d[d$AVG_INTERVAL_DP/12 < 20,]
data.frame(cbind(t$CHROM, t$POS, t$END))
dd =data.frame(cbind(t$CHROM, t$POS, t$END))
dd[sort(t$CHROM)]
dd[sort(t$CHROM),]
dd[sort(as.numeric(t$CHROM)),]
head(dd)
names(dd) <- c("chr", "start", "end")
head(dd)
dd[sort(dd$chr),]
dd =dd[sort(dd$chr),]
dd
dd[1:3,]
dd[2:4,]
dd
length(dd$chr)
uncovered <- function(d, t) {
length(d[d$AVG_INTERVAL_DP/12 < t,]$POS) / length(d$POS)
}
uncovered(d, 20)
uncovered(d, 20) * d$POS
uncovered(d, 20) * length(d$POS)
length(dd$chr)
uncovered(d, 20) * length(d$POS)
uncovered(d, 20)
write.table(dd, file="~/sandbox/cancer.uncovered.tbl")
View(d)
rm (o, m ,t)
rm(halo, dd)
u = subset(d, AVG_INTERVAL_DP / 12 < 20)
View(u)
write.table(u, "~/sandbox/clia/cancer.uncovered.tbl")
d <- cbind("10%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.1/GeneTest-transcripts-130221.intervals.vcf.tbl")
)
head(D)
head(d)
d <- rbind(d, cbind("20%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.2/GeneTest-transcripts-130221.intervals.vcf.tbl")))
names(d)
names(d)[2]
names(d)[2:-1]
names(d)[2:16]
names(d)[2:17]
names(d)[2:16]
names(d)[-1]
names(d) <- c("dataset", names(d)[-1])
tmp <- cbind("20%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.2/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(tmp) <- names(d)
d <- rbind(d, tmp)
summary(d)
tmp <- cbind("30%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.3/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(tmp) <- names(d)
d <- rbind(d, tmp)
tmp <- cbind("40%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.4/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(tmp) <- names(d)
d <- rbind(d, tmp)
tmp <- cbind("50%", read.delim("/humgen/gsa-hpprojects/dev/carneiro/clia/analysis/illumina_exome/downsample/down-0.5/GeneTest-transcripts-130221.intervals.vcf.tbl"))
names(tmp) <- names(d)
d <- rbind(d, tmp)
summary(d)
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
require("ggplot2")
install.packages("ggplot2")
require("ggplot2")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill="red", group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill=dataset, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_fill_discrete(guide = "none")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill=dataset, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", color=dataset, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill=dataset, alpha=0.4, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed")
qplot(AVG_INTERVAL_DP/12, data=d, geom="density", fill=dataset, alpha=0.2, group=dataset, xlab="Average depth per sample", ylab="% targets") + geom_vline(xintercept=20, linetype="dashed") + scale_alpha(guide="none")
uncovered <- function(d, t) {
length(d[d$AVG_INTERVAL_DP/12 < t,]$POS) / length(d$POS)
}
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(d=subset(d, dataset=="20%"), 20)
uncovered(d=subset(d, dataset=="30%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered <- function(d, t) {
percent_uncovered <- length(d[d$AVG_INTERVAL_DP/12 < t,]$POS) / length(d$POS)
c(percent_uncovered, percent_uncovered * length(d$POS))
}
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(d=subset(d, dataset=="20%"), 20)
uncovered(d=subset(d, dataset=="30%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered(d=subset(d, dataset=="50%"), 20)
uncovered <- function(data, t) {
percent_uncovered <- length(data[data$AVG_INTERVAL_DP/12 < t,]$POS) / length(data$POS)
c(percent_uncovered, percent_uncovered * length(data$POS))
}
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(subset(d, dataset=="10%"), 20)
uncovered <- function(data, t) {
data_points = length(data$POS)
percent_uncovered <- length(data[data$AVG_INTERVAL_DP/12 < t,]$POS) / data_points
c(percent_uncovered, percent_uncovered * data_points)
}
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered <- function(data, t) {
data_points = length(data$POS)
percent_uncovered <- length(data[data$AVG_INTERVAL_DP/12 < t,]$POS) / data_points
print(percent_uncovered)
print(percent_uncovered * data_points)
}
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered <- function(data, t) {
data_points = length(data$POS)
percent_uncovered <- length(data[data$AVG_INTERVAL_DP/12 < t,]$POS) / data_points
print(percent_uncovered, percent_uncovered * data_points)
}
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered <- function(data, t) {
data_points = length(data$POS)
percent_uncovered <- length(data[data$AVG_INTERVAL_DP/12 < t,]$POS) / data_points
print(cat(percent_uncovered, percent_uncovered * data_points))
}
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered <- function(data, t) {
data_points = length(data$POS)
percent_uncovered <- length(data[data$AVG_INTERVAL_DP/12 < t,]$POS) / data_points
cat(percent_uncovered, percent_uncovered * data_points)
}
uncovered(d=subset(d, dataset=="10%"), 20)
uncovered(d=subset(d, dataset=="20%"), 20)
uncovered(d=subset(d, dataset=="30%"), 20)
uncovered(d=subset(d, dataset=="40%"), 20)
uncovered(d=subset(d, dataset=="50%"), 20)
head(d)
original <- read.delim("/Volumes/Lothlorien/Dropbox/sandbox/clia/diagnose.cds.tbl")
